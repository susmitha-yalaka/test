{
  "version": "7.1",
  "data_api_version": "3.0",
  "routing_model": {
    "SELECT_TABLE": ["ADD_ITEMS"],
    "ADD_ITEMS": ["REVIEW_ORDER"],
    "REVIEW_ORDER": ["ORDER_CONFIRMED"],
    "ORDER_CONFIRMED": []
  },
  "screens": [
    {
      "id": "SELECT_TABLE",
      "title": "Select Table",
      "layout": {
        "type": "SingleColumnLayout",
        "children": [
          {
            "type": "NavigationList",
            "name": "table_list",
            "list-items": [
              {
                "id": "table_1",
                "main-content": { "title": "Table 1", "description": "In progress", "metadata": "2 seater" },
                "on-click-action": {
                  "name": "data_exchange",
                "payload": { "trigger": "init_add_items", "selectedTable": "table_1" }
                
                }
              },
              {
                "id": "table_2",
                "main-content": { "title": "Table 2", "description": "Payment pending", "metadata": "4 seater" },
                "on-click-action": {
                  "name": "data_exchange",
                "payload": { "trigger": "init_add_items", "selectedTable": "table_2" }
                
                }
              },
              {
                "id": "table_3",
                "main-content": { "title": "Table 3", "description": "Completed", "metadata": "8 seater" },
                "on-click-action": {
                "name": "data_exchange",
                "payload": { "trigger": "init_add_items", "selectedTable": "table_3" }
                }

              }
            ]
          }
        ]
      }
    },
    {
      "id": "ADD_ITEMS",
      "title": "Add Menu Items",
      "data": {
        "selectedTable": { "type": "string", "__example__": "table_1" },
        "menu_items_filtered": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "id": { "type": "string" },
              "title": { "type": "string" },
              "description": { "type": "string" }
            }
          },
          "__example__": [
            { "id": "1", "title": "Pizza", "description": "₹300" },
            { "id": "2", "title": "Burger", "description": "₹150" }
          ]
        },
        "cart": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "id": { "type": "string" },
              "title": { "type": "string" },
              "price": { "type": "number" },
              "quantity": { "type": "integer" }
            }
          },
          "__example__": [
            { "id": "1", "title": "Pizza", "price": 300, "quantity": 2 },
            { "id": "2", "title": "Burger", "price": 150, "quantity": 1 }
          ]
        },
        "cart_review_text": { "type": "string", "__example__": "Pizza x 2 – ₹600\nBurger x 1 – ₹150" },
        "total": { "type": "string", "__example__": "750" }
      },
      "layout": {
        "type": "SingleColumnLayout",
        "children": [
          { "type": "TextCaption", "text": "Selected Table: ${data.selectedTable}" },
          { "type": "TextInput", "name": "search_item", "label": "Search Menu Item", "input-type": "text" },
          {
            "type": "EmbeddedLink",
            "text": "Search for Items",
            "on-click-action": {
              "name": "data_exchange",
              "payload": { "trigger": "filter_menu_items", "search_query": "${form.search_item}" }
            }
          },
          {
            "type": "Dropdown",
            "name": "menu_item",
            "label": "Select Menu Item",
            "data-source": "${data.menu_items_filtered}",
            "required": true
          },
          {
            "type": "Dropdown",
            "name": "item_quantity",
            "label": "Quantity",
            "data-source": [
              { "id": "1", "title": "1" }, { "id": "2", "title": "2" }, { "id": "3", "title": "3" },
              { "id": "4", "title": "4" }, { "id": "5", "title": "5" }
            ],
            "required": true
          },
          { "type": "TextCaption", "text": "Current Cart:" },
          { "type": "TextBody", "text": "${data.cart_review_text}" },
          {
            "type": "EmbeddedLink",
            "text": "Add Item to Cart",
            "on-click-action": {
              "name": "data_exchange",
              "payload": {
                "trigger": "add_item_to_cart",
                "menu_item_id": "${form.menu_item}",
                "quantity": "${form.item_quantity}"
              }
            }
          },
          {
            "type": "Footer",
            "label": "Proceed to Review",
            "on-click-action": {
              "name": "data_exchange",
              "payload": { "trigger": "init_review_order" }
            }
          }

        ]
      }
    },
    {
      "id": "REVIEW_ORDER",
      "title": "Review Order",
      "data": {
        "selectedTable": { "type": "string", "__example__": "table_1" },
        "cart_review_text": { "type": "string", "__example__": "Pizza x 2 – ₹600\nBurger x 1 – ₹150" },
        "total": { "type": "string", "__example__": "750" }
      },
      "layout": {
        "type": "SingleColumnLayout",
        "children": [
          { "type": "TextCaption", "text": "Selected Table: ${data.selectedTable}" },
          { "type": "TextCaption", "text": "Order Summary:" },
          { "type": "TextBody", "text": "${data.cart_review_text}" },
          { "type": "TextCaption", "text": "Total Bill:" },
          { "type": "TextBody", "text": "${data.total}" },
          {
            "type": "EmbeddedLink",
            "text": "Add More Items",
            "on-click-action": { "name": "navigate", "next": { "name": "ADD_ITEMS", "type": "screen" } }
          },
          {
            "type": "Footer",
            "label": "Confirm Order",
            "on-click-action": {
              "name": "data_exchange",
              "payload": { "trigger": "confirm_order" }
            }
          }
        ]
      }
    },
    {
      "id": "ORDER_CONFIRMED",
      "title": "Order Confirmed",
      "terminal": true,
      "data": {
        "confirmation_message": { "type": "string", "__example__": "Your order has been placed successfully!" }
      },
      "layout": {
        "type": "SingleColumnLayout",
        "children": [{ "type": "TextBody", "text": "${data.confirmation_message}" }]
      }
    }
  ]
}
